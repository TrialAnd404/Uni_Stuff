#VRML V2.0 utf8
PROTO Eislaeufer [
    exposedField SFColor color 1 0 0
    exposedField SFTime toggleTime 0
    exposedField SFBool active FALSE
    exposedField SFBool lightOn FALSE
    field SFString name "GZUZ"
    ]{



DEF Eislaeufer Transform {
    translation 0 1 0
	children [
       	DEF	torso Shape	{
			geometry IndexedFaceSet	{
				coord Coordinate {
                    point	[
					    #Torso
                        #Front
						-1.5 6 0.5
                        1.5 6 0.5       
                        -1 3 0.3
                        1 3 0.3
                        #Back
                        -1.5 6 -0.5
                        1.5 6 -0.5
                        -1 3 -0.3
                        1 3 -0.3
				    ]
                }

				coordIndex [
                    #vorne 
                    0 2 3 1 -1
                    #hinten
                    4 5 7 6 -1
                    #oben
                    0 1 5 4 -1
                    #unten
                    2 3 7 6 -1
                    #links
                    0 2 6 4 -1 
                    #rechts
                    1 3 7 5 -1
				]
				solid FALSE
			} #Indecedfaceset

			appearance Appearance {
				material Material {
				} 
			} #Appearance
		} #torso

        #Kopf
		Transform {
			translation	0 7 0
			children [
				Viewpoint {
					position 0 0 0
				}
				DEF	head Shape {
					geometry Sphere	{
						radius	.8
					}

					appearance Appearance {
						material Material {
                            diffuseColor IS color
						}
					} #Appearance
				} #head
            ]
		}

        DEF linkerArm Transform{
            center -1.6 5.8 0
            children[
                Shape{
			        geometry IndexedFaceSet	{
				        coord Coordinate {point	[
					        #Arm
                            #schulter
						    -1.6 6 0
                            -1.6 5.7 0.3
                            -1.6 5.7 -0.3
                            -1.8 5.7 0
                            #hand
                            -1.5 3 0
				        ]}

				        coordIndex [  
                            #schulter
                            0 2 3 -1
                            0 1 3 -1
                            0 1 2 -1
                            #arm
                            1 3 4 -1
                            2 3 4 -1
                            1 2 4 -1
				        ]
				        solid FALSE
			        } #Indecedfaceset

			        appearance Appearance {
				        material Material {
				        } 
			        } #Appearance
                }
                #Hand
                Transform{
                    translation -1.5 3.2 0
                    rotation 1 0 0 1.508
                    children[
                        Shape{
                            geometry Sphere{
                                radius 0.2
                            }
                            appearance Appearance {
				                material Material {
				                } 
			                }
                        }
                    ]
                }
            ]
		}

        DEF	rechterArm Transform {
			rotation 0 1 0 3.1415
			children[
				USE	linkerArm
                #Taschenlampe
                Transform{
                    translation -1.5 3.2 0
                    rotation 1 0 0 1.508
                    children[
                        Shape {
                            geometry Cylinder {
                                radius 0.1
                                height 0.7
                                bottom TRUE
                                top TRUE
                                side TRUE
                            }
                            appearance Appearance {
				                material Material {
				                } 
			                }
                        }
                        Transform{
                            translation 0 -0.3 0
                            children[
                                Shape{
                                    geometry Cone {
                                        bottomRadius 0.15
                                        height 0.2
                                        bottom TRUE
                                        side TRUE
                                    }
                                    appearance Appearance {
				                        material Material {
				                        } 
			                        }
                                }
                                SpotLight{
                                    on IS lightOn
                                    intensity 0.8
                                    ambientIntensity 0.5 
                                    color 0.6 0.6 0.4
                                    location 0 0 0
                                    attenuation 1 0 0
                                    direction 0 -1 0
                                    beamWidth 0.5
                                    cutOffAngle 0.785398
                                    radius 500
                                }
                            ]
                        }
                    ]
                }
            ]
		}

		DEF linkesBein Transform{
            translation .6 3 0 
			children[
				Transform{
					children[
                        #Becken
						Shape{
						    geometry Sphere{
							    radius .35
						    }
						    appearance Appearance {
						        material Material{
							    }
						    }
                        }
                        #Bein
                        Transform{
						    children[
							    Shape{
			                        geometry IndexedFaceSet	{
				                        coord Coordinate {
                                            point	[
					                            #Bein
                                                #Hüfte
						                        0 0.25 0.5
                                                -0.4 -0.2 0.1
                                                0.4 -0.2 0.1
                                                0 -0.45 -0.3
                                                0 -4 0
				                            ]
                                        }
				                        coordIndex [  
                                            #Bein
                                            #Hüfte
                                            0 1 3 2 -1
                                            4 0 2 -1
                                            4 2 3 -1
                                            4 3 1 -1
                                            4 1 0 -1
				                        ]
				                        solid FALSE
			                        } #Indecedfaceset
			                        appearance Appearance {
				                        material Material {
				                        } 
			                        } #Appearance
                                }

                                DEF fussLinks Shape{
			                        geometry IndexedFaceSet	{
				                        coord Coordinate {
                                            point	[
                                                #Fuß
                                                0 -3.7 0
                                                -0.3 -4 0.8
                                                0.3 -4 0.8
                                                0.3 -4 -0.2
                                                -0.3 -4 -0.2

                                                #Kufen
                                                0.005 -4 0.8
                                                0.005 -4.2 0.6
                                                0.005 -4.2 0
                                                0.005 -4 -0.2
                                                -0.005 -4 0.8
                                                -0.005 -4.2 0.6
                                                -0.005 -4.2 0
                                                -0.005 -4 -0.2
				                            ]
                                        }
				                        coordIndex [ 
                                            #Fuß
                                            1 2 3 4 -1
                                            4 0 2 -1
                                            4 3 0 -1
                                            1 4 0 -1
                                            0 2 1 -1

                                            #Kufen
                                            5 8 7 6 -1
                                            9 12 10 9 -1
                                            5 6 10 9 -1
                                            5 6 10 9 -1
				                        ]
				                        solid FALSE
			                        } #Indecedfaceset
			                        appearance Appearance {
				                        material Material {
                                            diffuseColor IS color
				                        } 
			                        } #Appearance
                                }
					        ]
					    }

                        
					]
				}
			]
		}
        DEF	rechtesBein Transform {
			
            center 0.6 3 0
            translation -1.2 0 0
            
			
			children
				USE	linkesBein
		}
        Viewpoint { 
	        position 0 7 0
            description IS name
            orientation 0 1 0 3.1415
        }

	] #children
}

DEF BewegungTimer TimeSensor{
    cycleInterval 5
    startTime IS toggleTime
	enabled IS active
	loop IS active
}

DEF BewegungTest OrientationInterpolator{
                    key [
                        0 .2 .4 .6 .8 1
                    ]
                    keyValue[
						0 0 0 0
						1 0 0 -0.7
						0 0 0 0
						1 0 0 0.7
						0 0 0 0

                    ]
                }

DEF Bewegung2Test OrientationInterpolator{
                    key [
                        0 .2 .4 .6 .8 1
                    ]
                    keyValue[
						0 0 0 0
						1 0 0 0.7
						0 0 0 0	
                    ]
                }

DEF ToggleAnimation Script {
eventIn SFTime toggle

field SFNode laueferNode USE Eislaeufer
field SFNode timer USE BewegungTimer
field SFTime pause 0
url["javascript:
    function toggle(currentTime) {
        if( timer.isActive ) {
            pause = currentTime - timer.startTime_changed;
        }
        else {
            timer.set_startTime = currentTime - pause;
            pause = 0;
        }
    }"]
}

ROUTE BewegungTimer.startTime TO ToggleAnimation.toggle

ROUTE BewegungTimer.fraction_changed TO BewegungTest.set_fraction
ROUTE BewegungTimer.fraction_changed TO Bewegung2Test.set_fraction
ROUTE BewegungTest.value_changed TO rechtesBein.set_rotation
ROUTE Bewegung2Test.value_changed TO linkesBein.set_rotation

}